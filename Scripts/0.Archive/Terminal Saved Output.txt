Last login: Tue Mar 10 16:40:42 on ttys001
Welcome to qbox.
qbox:~ $ 
qbox:~ $   export PATH="/Applications/Postgres.app/Contents/Versions/9.4/bin/":$PATH
qbox:~ $ 
qbox:~ $   # Create a database to hold the FIA data
qbox:~ $     # Set a name for the database.
qbox:~ $     DATABASE="fia5data_csvimport2"     # Desired database name
qbox:~ $ 
qbox:~ $     # Delete the database if it exists already. 
qbox:~ $     # *** Careful! Only do this is you really mean it! ***
qbox:~ $     # If the database doesn't exist and you run this, a harmless warning will print.
qbox:~ $     dropdb --if-exists ${DATABASE}

    # Now create the new database with the name set above
    createdb ${DATABASE}

  # Create an empty PSQL database from the FIA schema, obtained by either:
  #  1. Downloading and converting the MS Access schema available directly from USFS at
  #     http://apps.fs.fed.us/fiadb-downloads/images/FIADB_version5_1.accdb
  #  2. Download an already converted copy, current as of Feb. 2015, at
  #     https://duke.box.com/s/sz6jz8oejkkdhxt4e7ej3zaz5gsmbhmg

    # Specify path to the PSQL schema, e.g. .../FIADB_version5_1.psql
    DB_PSQLDUMP="/Volumes/Gonzo/Pecan/FIA/FIADB_version5_1_RKedit01.psql"

    # Import schema. Note, you may get 'notices' here warning that tables don't exist. These are normal and can be ignored. 
    psql -d ${DATABASE} < ${DB_PSQLDUMP}

  # Now import .csv files containing the FIA data, obtained by either:
  #  1. Downloading zipped .csv files from FIA DataMart at
  #     http://apps.fs.fed.us/fiadb-downloads/datamart.html
  #  2. Downloading the entire database inqbox:~ $ 
qbox:~ $     # Now create the new database with the name set above
qbox:~ $     createdb ${DATABASE}

  # Create an empty PSQL database from the FIA schema, obtained by either:
  #  1. Downloading and converting the MS Access schema available directly from USFS at
  #     http://apps.fs.fed.us/fiadb-downloads/images/FIADB_version5_1.accdb
  #  2. Download an already converted copy, current as of Feb. 2015, at
  #     https://duke.box.com/s/sz6jz8oejkkdhxt4e7ej3zaz5gsmbhmg

    # Specify path to the PSQL schema, e.g. .../FIADB_version5_1.psql
    DB_PSQLDUMP="/Volumes/Gonzo/Pecan/FIA/FIADB_version5_1_RKedit01.psql"

    # Import schema. Note, you may get 'notices' here warning that tables don't exist. These are normal and can be ignored. 
    psql -d ${DATABASE} < ${DB_PSQLDUMP}

  # Now import .csv files containing the FIA data, obtained by either:
  #  1. Downloading zipped .csv files from FIA DataMart at
  #     http://apps.fs.fed.us/fiadb-downloads/datamart.html
  #  2. Downloading the entire database in one big .zip archive, current as of Feb. 2015, at:
  #     https://duke.box.com/s/4x4qbox:~ $ 
qbox:~ $   # Create an empty PSQL database from the FIA schema, obtained by either:
qbox:~ $   #  1. Downloading and converting the MS Access schema available directly from USFS at
qbox:~ $   #     http://apps.fs.fed.us/fiadb-downloads/images/FIADB_version5_1.accdb
qbox:~ $   #  2. Download an already converted copy, current as of Feb. 2015, at
qbox:~ $   #     https://duke.box.com/s/sz6jz8oejkkdhxt4e7ej3zaz5gsmbhmg
qbox:~ $ 
qbox:~ $     # Specify path to the PSQL schema, e.g. .../FIADB_version5_1.psql
qbox:~ $     DB_PSQLDUMP="/Volumes/Gonzo/Pecan/FIA/FIADB_version5_1_RKedit01.psql"
qbox:~ $ 
qbox:~ $     # Import schema. Note, you may get 'notices' here warning that tables don't exist. These are normal and can be ignored. 
qbox:~ $     psql -d ${DATABASE} < ${DB_PSQLDUMP}
NOTICE:  table "boundary" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "cond" does not exist, skipping
DROP TABLE

  # Now import .csv files containing the FIA data, obtained by either:
  #  1. Downloading zipped .csv files from FIA DataMart at
  #     http://apps.fs.fed.us/fiadb-downloads/datamart.html
  #  2. Downloading the entire database in one big .zip archive, current as of Feb. 2015, at:
  #     https://duke.box.com/s/4x4s5u0obploc2ttl07tvi0ii9d8nrjc
  #     * Note this same file ("ENTIRE.zip") is available from the DataMart website (scroll
  #       to very bottom of the page), but that site is very slow. 

  # Regardless of where the files were obtained, unzip them and point to the directory 
  # containg the .csv files here:
    DATA_DIR="/Volumes/Gonzo/Pecan/FIA/ENTIRE/"  

  # Now loop over all of the .csv files and import each into the (currently empty) PSQL database
    cd ${DATA_DIR}

    for g in ./*.CSV; do
      table=$(basename $g .CSV | sed "s/^${f}_//" | tr '[A-Z]' '[a-z]')
      if [[ "${table}" == ${f}_* ]]; then
        table=${table:3}
      fi
      echo "  Loading ${g} intCREATE TABLE
NOTICE:  table "cond_dwm_calc" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "county" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "dwm_coarse_woody_debris" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "dwm_duff_litter_fuel" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "dwm_fine_woody_debris" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "dwm_microplot_fuel" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "dwm_residual_pile" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "dwm_transect_segment" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "dwm_visit" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "evalidator_changes" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "invasive_subplot_spp" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "lichen_lab" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "lichen_plot_summary" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "lichen_species_summary" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "lichen_visit" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ozone_biosite_summary" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ozone_plot" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ozone_plot_summary" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ozone_species_summary" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ozone_validation" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ozone_visit" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "p2veg_subp_structure" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "p2veg_subplot_spp" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "plot" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "plot_regen" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "plotgeom" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "plotsnap" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "pop_estn_unit" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "pop_eval" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "pop_eval_attribute" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "pop_eval_grp" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "pop_eval_typ" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "pop_plot_stratum_assgn" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "pop_stratum" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_attribute_access" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_citation" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_fiadb_version" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_forest_type" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_forest_type_group" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_habtyp_description" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_habtyp_publication" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_invasive_species" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_lichen_species" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_lichen_spp_comments" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_plant_dictionary" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_pop_attribute" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_pop_eval_typ_descr" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_prc" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_research_station" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_rscdevalid" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_species" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_species_group" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_state_elev" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "ref_unit" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "seedling" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "seedling_regen" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "sitetree" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "soils_erosion" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "soils_lab" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "soils_sample_loc" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "soils_visit" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "subp_cond" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "subp_cond_chng_mtrx" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "subplot" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "subplot_regen" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "survey" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "tempestnunitdescrlu" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "tree" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "tree_grm_estn" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "tree_regional_biomass" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "veg_plot_species" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "veg_quadrat" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "veg_subplot" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "veg_subplot_spp" does not exist, skipping
DROP TABLE
CREATE TABLE
NOTICE:  table "veg_visit" does not exist, skipping
DROP TABLE
CREATE TABLE
qbox:~ $ 
qbox:~ $   # Now import .csv files containing the FIA data, obtained by either:
qbox:~ $   #  1. Downloading zipped .csv files from FIA DataMart at
qbox:~ $   #     http://apps.fs.fed.us/fiadb-downloads/datamart.html
qbox:~ $   #  2. Downloading the entire database in one big .zip archive, current as of Feb. 2015, at:
qbox:~ $   #     https://duke.box.com/s/4x4s5u0obploc2ttl07tvi0ii9d8nrjc
qbox:~ $   #     * Note this same file ("ENTIRE.zip") is available from the DataMart website (scroll
qbox:~ $   #       to very bottom of the page), but that site is very slow. 
qbox:~ $ 
qbox:~ $   # Regardless of where the files were obtained, unzip them and point to the directory 
qbox:~ $   # containg the .csv files here:
qbox:~ $     DATA_DIR="/Volumes/Gonzo/Pecan/FIA/ENTIRE/"  
qbox:~ $ 
qbox:~ $   # Now loop over all of the .csv files and import each into the (currently empty) PSQL database
qbox:~ $     cd ${DATA_DIR}
qbox:ENTIRE $ 
qbox:ENTIRE $     for g in ./*.CSV; do
>       table=$(basename $g .CSV | sed "s/^${f}_//" | tr '[A-Z]' '[a-z]')
>       if [[ "${table}" == ${f}_* ]]; then
>         table=${table:3}
>       fi
>       echo "  Loading ${g} into table ${DATABASE}.${table}..."
>       psql -d ${DATABASE} -c "\COPY ${table} FROM '${g}' WITH CSV HEADER DELIMITER AS ',' NULL AS '' ENCODING 'UTF-8'"
>     done
  Loading ./BOUNDARY.CSV into table fia5data_csvimport2.boundary...
COPY 140567
  Loading ./COND.CSV into table fia5data_csvimport2.cond...
COPY 1633114
  Loading ./COND_DWM_CALC.CSV into table fia5data_csvimport2.cond_dwm_calc...
COPY 101512
  Loading ./COUNTY.CSV into table fia5data_csvimport2.county...
COPY 3204
  Loading ./DWM_COARSE_WOODY_DEBRIS.CSV into table fia5data_csvimport2.dwm_coarse_woody_debris...
COPY 404195
  Loading ./DWM_DUFF_LITTER_FUEL.CSV into table fia5data_csvimport2.dwm_duff_litter_fuel...
COPY 549376
  Loading ./DWM_FINE_WOODY_DEBRIS.CSV into table fia5data_csvimport2.dwm_fine_woody_debris...
COPY 150699
  Loading ./DWM_MICROPLOT_FUEL.CSV into table fia5data_csvimport2.dwm_microplot_fuel...
COPY 147695
  Loading ./DWM_RESIDUAL_PILE.CSV into table fia5data_csvimport2.dwm_residual_pile...
COPY 2372
  Loading ./DWM_TRANSECT_SEGMENT.CSV into table fia5data_csvimport2.dwm_transect_segment...
COPY 918713
  Loading ./DWM_VISIT.CSV into table fia5data_csvimport2.dwm_visit...
COPY 91433
  Loading ./INVASIVE_SUBPLOT_SPP.CSV into table fia5data_csvimport2.invasive_subplot_spp...
COPY 29930
  Loading ./LICHEN_LAB.CSV into table fia5data_csvimport2.lichen_lab...
COPY 21354
  Loading ./LICHEN_PLOT_SUMMARY.CSV into table fia5data_csvimport2.lichen_plot_summary...
COPY 1956
  Loading ./LICHEN_VISIT.CSV into table fia5data_csvimport2.lichen_visit...
COPY 3857
  Loading ./OZONE_BIOSITE_SUMMARY.CSV into table fia5data_csvimport2.ozone_biosite_summary...
COPY 8543
  Loading ./OZONE_PLOT.CSV into table fia5data_csvimport2.ozone_plot...
COPY 8879
  Loading ./OZONE_PLOT_SUMMARY.CSV into table fia5data_csvimport2.ozone_plot_summary...
COPY 8856
  Loading ./OZONE_SPECIES_SUMMARY.CSV into table fia5data_csvimport2.ozone_species_summary...
COPY 26868
  Loading ./OZONE_VALIDATION.CSV into table fia5data_csvimport2.ozone_validation...
COPY 6876
  Loading ./OZONE_VISIT.CSV into table fia5data_csvimport2.ozone_visit...
COPY 8879
  Loading ./P2VEG_SUBPLOT_SPP.CSV into table fia5data_csvimport2.p2veg_subplot_spp...
COPY 435930
  Loading ./P2VEG_SUBP_STRUCTURE.CSV into table fia5data_csvimport2.p2veg_subp_structure...
COPY 3735988
  Loading ./PLOT.CSV into table fia5data_csvimport2.plot...
COPY 1465241
  Loading ./PLOTGEOM.CSV into table fia5data_csvimport2.plotgeom...
COPY 1452698
  Loading ./PLOTSNAP.CSV into table fia5data_csvimport2.plotsnap...
COPY 3260694
  Loading ./PLOT_REGEN.CSV into table fia5data_csvimport2.plot_regen...
COPY 2128
  Loading ./POP_ESTN_UNIT.CSV into table fia5data_csvimport2.pop_estn_unit...
COPY 38600
  Loading ./POP_EVAL.CSV into table fia5data_csvimport2.pop_eval...
COPY 1633
  Loading ./POP_EVAL_ATTRIBUTE.CSV into table fia5data_csvimport2.pop_eval_attribute...
COPY 48185
  Loading ./POP_EVAL_GRP.CSV into table fia5data_csvimport2.pop_eval_grp...
COPY 531
  Loading ./POP_EVAL_TYP.CSV into table fia5data_csvimport2.pop_eval_typ...
COPY 3116
  Loading ./POP_PLOT_STRATUM_ASSGN.CSV into table fia5data_csvimport2.pop_plot_stratum_assgn...
COPY 8764595
  Loading ./POP_STRATUM.CSV into table fia5data_csvimport2.pop_stratum...
COPY 123826
  Loading ./SEEDLING.CSV into table fia5data_csvimport2.seedling...
COPY 1907853
  Loading ./SEEDLING_REGEN.CSV into table fia5data_csvimport2.seedling_regen...
COPY 367362
  Loading ./SITETREE.CSV into table fia5data_csvimport2.sitetree...
COPY 500653
  Loading ./SOILS_EROSION.CSV into table fia5data_csvimport2.soils_erosion...
COPY 27541
  Loading ./SOILS_LAB.CSV into table fia5data_csvimport2.soils_lab...
COPY 22204
  Loading ./SOILS_SAMPLE_LOC.CSV into table fia5data_csvimport2.soils_sample_loc...
COPY 22100
  Loading ./SOILS_VISIT.CSV into table fia5data_csvimport2.soils_visit...
COPY 7719
  Loading ./SUBPLOT.CSV into table fia5data_csvimport2.subplot...
COPY 5548804
  Loading ./SUBPLOT_REGEN.CSV into table fia5data_csvimport2.subplot_regen...
COPY 8512
  Loading ./SUBP_COND.CSV into table fia5data_csvimport2.subp_cond...
COPY 4451459
  Loading ./SUBP_COND_CHNG_MTRX.CSV into table fia5data_csvimport2.subp_cond_chng_mtrx...
COPY 2619035
  Loading ./SURVEY.CSV into table fia5data_csvimport2.survey...
COPY 1145
  Loading ./TREE.CSV into table fia5data_csvimport2.tree...
COPY 18644082
  Loading ./TREE_GRM_ESTN.CSV into table fia5data_csvimport2.tree_grm_estn...
COPY 37799195
  Loading ./TREE_REGIONAL_BIOMASS.CSV into table fia5data_csvimport2.tree_regional_biomass...
COPY 16375635
  Loading ./VEG_PLOT_SPECIES.CSV into table fia5data_csvimport2.veg_plot_species...
COPY 162735
  Loading ./VEG_QUADRAT.CSV into table fia5data_csvimport2.veg_quadrat...
COPY 35673
  Loading ./VEG_SUBPLOT.CSV into table fia5data_csvimport2.veg_subplot...
COPY 13820
  Loading ./VEG_SUBPLOT_SPP.CSV into table fia5data_csvimport2.veg_subplot_spp...
COPY 337197
  Loading ./VEG_VISIT.CSV into table fia5data_csvimport2.veg_visit...
COPY 3455
qbox:ENTIRE $ 
qbox:ENTIRE $ 
qbox:ENTIRE $ 
